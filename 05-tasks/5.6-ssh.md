# 使用 SSH 连接工作台

## 配置 SSH 客户端公钥

只有使用已注册的客户端公钥才能使用 SSH 登录工作台. 首次使用请生成并注册 SSH 客户端密钥.

1. 在自己的电脑上生成 SSH 客户端密钥:

    ```sh
    $ ssh-keygen -t rsa -C "<your-email>" -b 4096
    ```

    将 `<your-email>` 替换为自己的邮箱地址, 默认密钥生成在 `~/.ssh/id_rsa`, 包含私钥 `~/.ssh/id_rsa` 和对应公钥 `~/.ssh/id_rsa.pub`.

    > - 请保护好私钥, 公钥可提供给需要连接的服务方. **私钥意外泄露后需立即修改**.
    > - 生成密钥时可以选择启用密码, 每次使用密钥时需输入密码.
    > - 如果选择将密钥生成在其它目录, 使用时需修改 ssh 登录配置, 详见下文.

2. 登录 AVA Portal, 在设置中注册公钥.

    todo: 截图

## 登录工作台

### 使用默认密钥登录

启动工作台后, 查看 SSH 端口, 复制登录命令, 如 `ssh root@<server-ip> -p <port>` 在终端执行:

todo: 截图

### 使用自定义密钥登录

1. 修改 SSH 配置 `~/.ssh/config`, 添加以下内容:

    ```
    Host workspace                          # 自定义服务器名称
        HostName <server-ip>                # ssh 服务器 ip, 通过 ava portal 查询
        User root                           # 登录用户名, 固定为 root
        IdentityFile </path/to/your/key>    # 自定义密钥, 如 /Users/<your-name>/.ssh/id_rsa_ava

    Host *
        ServerAliveInterval 3600            #
        ServerAliveCountMax 2
    ```

2. SSH 登录:

   ```sh
   $ ssh workspace -p <port>
   ```
